<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Present Subjunctive: Dynamic Master</title>
    
    <style>
        :root {
            /* Paleta Azul Est√°ndar (Coherencia Suite) */
            --primary: #007bff;
            --dark-blue: #0056b3;
            --green: #28a745;
            --red: #dc3545;
            --yellow: #f0ad4e;
            
            --bg-color: #f0f4f8;
            --container-bg: #ffffff;
            --text-color: #333;
            --header-bg: linear-gradient(135deg, var(--primary), var(--dark-blue));
            --tab-bg: #f1f1f1;
            --border-color: #dee2e6;
            --light-gray-bg: #f8f9fa;
        }

        /* Modo Oscuro */
        body.dark-mode {
            --bg-color: #121212;
            --container-bg: #1e1e1e;
            --text-color: #e0e0e0;
            --header-bg: #1e1e1e;
            --tab-bg: #333;
            --border-color: #444;
            --light-gray-bg: #2a2a2a;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            line-height: 1.6;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            transition: background-color 0.3s, color 0.3s;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background-color: var(--container-bg);
            border-radius: 12px;
            box-shadow: 0 6px 20px rgba(0,0,0,0.07);
            overflow: hidden;
            transition: background-color 0.3s;
        }

        /* Header */
        header {
            background: var(--header-bg);
            color: white;
            padding: 25px 35px;
            text-align: center;
            position: relative;
        }
        header h1 { margin: 0; font-size: 2.2em; letter-spacing: -0.5px; }
        header p { margin: 5px 0 0; opacity: 0.9; font-size: 1.1em; }

        .header-controls {
            position: absolute;
            top: 20px;
            right: 20px;
        }
        .control-button {
            background: rgba(255,255,255,0.2);
            border: 1px solid rgba(255,255,255,0.7);
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: bold;
            transition: background 0.2s;
        }
        .control-button:hover { background: rgba(255,255,255,0.4); }

        /* Pesta√±a Visual */
        .nav-tabs {
            display: flex;
            background: var(--tab-bg);
            border-bottom: 3px solid var(--dark-blue);
        }
        .nav-tab {
            padding: 15px 25px;
            border: none;
            background: var(--container-bg);
            cursor: default;
            font-size: 1.1em;
            font-weight: bold;
            color: var(--primary);
            border-top: 4px solid var(--primary);
            flex-grow: 1;
            text-align: center;
        }

        /* Main Content */
        main { padding: 30px; }

        /* Controls Section */
        .controls-area {
            background: var(--light-gray-bg);
            padding: 20px;
            border-radius: 10px;
            border: 1px solid var(--border-color);
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            align-items: center;
            margin-bottom: 30px;
        }
        
        select {
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #ccc;
            font-size: 1em;
            background-color: var(--container-bg);
            color: var(--text-color);
            min-width: 200px;
        }

        .btn-action {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.1s;
        }
        .btn-action:active { transform: scale(0.98); }
        
        .btn-hide { background-color: var(--text-color); color: var(--bg-color); border: 1px solid var(--text-color); }
        .btn-show { background-color: var(--primary); color: white; }

        /* Cards Grid */
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        /* Verb Card Styling */
        .verb-card {
            background: var(--container-bg);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 20px;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            animation: fadeIn 0.5s;
        }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .verb-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0,0,0,0.1);
            border-color: var(--primary);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            border-bottom: 2px solid var(--light-gray-bg);
            padding-bottom: 10px;
        }
        .verb-title {
            font-size: 1.4em;
            font-weight: bold;
            color: var(--primary);
            text-transform: capitalize;
        }
        .verb-tag {
            font-size: 0.8em;
            background: var(--light-gray-bg);
            color: #666;
            padding: 4px 8px;
            border-radius: 12px;
            border: 1px solid var(--border-color);
        }

        /* Table Styling */
        table { width: 100%; border-collapse: collapse; font-size: 0.95em; }
        td { padding: 8px 5px; border-bottom: 1px solid var(--light-gray-bg); }
        tr:last-child td { border-bottom: none; }
        
        .pronoun { color: #888; width: 45%; font-size: 0.9em; }
        .form { font-weight: bold; color: var(--text-color); cursor: pointer;}
        .form.hidden-form { color: var(--primary); background-color: rgba(0,123,255,0.1); padding: 2px 5px; border-radius: 4px; }
        
        .stem-change { color: var(--red); }

        /* Chip Row */
        .chip-row {
            margin-top: 15px;
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
        }
        .chip {
            background: #e3f2fd;
            color: var(--dark-blue);
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 0.85em;
            font-weight: bold;
        }
        body.dark-mode .chip { background: #2c3e50; color: #aab7c4; }

        /* Audio Icon */
        .tts-icon {
            font-size: 1em;
            cursor: pointer;
            margin-left: 8px;
            opacity: 0.7;
            transition: opacity 0.2s, transform 0.2s;
        }
        .tts-icon:hover { opacity: 1; transform: scale(1.2); }
        
        .hint-text {
            text-align: center;
            margin-top: 30px;
            color: #777;
            font-style: italic;
            font-size: 0.9em;
        }

    </style>
</head>
<body>

    <div class="container">
        <header>
            <div class="header-controls">
                <button class="control-button" onclick="toggleLang()">EN / ES</button>
                <button class="control-button" onclick="toggleTheme()">‚òÄÔ∏è/üåô</button>
            </div>
            <h1 id="app-title">Presente del Subjuntivo</h1>
            <p id="app-subtitle">Activity 16: Dynamic Verb Practice</p>
        </header>
        
        <div class="nav-tabs">
            <div class="nav-tab">‚úçÔ∏è Pr√°ctica Interactiva</div>
        </div>

        <main>
            <div class="controls-area">
                <div style="flex-grow: 1; text-align: center;">
                    <label style="font-weight:bold; margin-right:10px;" id="lbl-filter">Filtrar Verbo:</label>
                    <select id="verbSelect">
                        <option value="all">Todos (All)</option>
                        </select>
                </div>
                <div>
                    <button id="hideBtn" class="btn-action btn-hide">üëÅÔ∏è Ocultar (Hide)</button>
                    <button id="showBtn" class="btn-action btn-show">üëÅÔ∏è Mostrar (Show)</button>
                </div>
            </div>

            <div class="cards-grid" id="cardsContainer"></div>

            <p class="hint-text" id="app-hint">
                Tip: Click "Hide", try to pronounce it, then click üîä to check.
            </p>
        </main>
    </div>

<script>
    
    // ======================================================
    // üü¢ ZONA DE EDICI√ìN DEL PROFESOR
    // Aqu√≠ agregas tus verbos. 
    // Si es REGULAR, solo pon 'auto: true'.
    // Si es IRREGULAR, llena el array 'forms' con las 6 formas.
    // ======================================================
    
    const verbDatabase = [
        {
            verb: "tener",
            tag: "Irregular (yo-go)",
            auto: false, // Es irregular, definimos las formas
            forms: ["tenga", "tengas", "tenga", "tengamos", "teng√°is", "tengan"]
        },
        {
            verb: "desaparecer",
            tag: "-ZC (desaparezco)",
            auto: false,
            forms: ["desaparezca", "desaparezcas", "desaparezca", "desaparezcamos", "desaparezc√°is", "desaparezcan"]
        },
        {
            verb: "decidir",
            tag: "Regular -IR",
            auto: true // ¬°Magia! Se conjuga solo
        },
        {
            verb: "cuestionar",
            tag: "Regular -AR",
            auto: true // ¬°Magia!
        },
        {
            verb: "hablar", // Nuevo que pediste
            tag: "Regular -AR",
            auto: true // ¬°Magia!
        },
        {
            verb: "aprender", // Nuevo que pediste
            tag: "Regular -ER",
            auto: true // ¬°Magia!
        },
        {
            verb: "hacer",
            tag: "Irregular (yo-go)",
            auto: false,
            forms: ["haga", "hagas", "haga", "hagamos", "hag√°is", "hagan"]
        },
        {
            verb: "ver",
            tag: "Irregular (veo)",
            auto: false,
            forms: ["vea", "veas", "vea", "veamos", "ve√°is", "vean"]
        },
        {
            verb: "sentirse",
            tag: "Cambio (e -> ie)",
            auto: false,
            forms: ["me sienta", "te sientas", "se sienta", "nos sintamos", "os sint√°is", "se sientan"]
        },
        {
            verb: "venir", // Nuevo
            tag: "Irregular (vengo)",
            auto: false,
            forms: ["venga", "vengas", "venga", "vengamos", "veng√°is", "vengan"]
        },
        {
            verb: "reconocer", // Nuevo
            tag: "-ZC (reconozco)",
            auto: false,
            forms: ["reconozca", "reconozcas", "reconozca", "reconozcamos", "reconozc√°is", "reconozcan"]
        },
        {
            verb: "mostrarse", // Nuevo
            tag: "Reflexivo (o -> ue)",
            auto: false,
            forms: ["me muestre", "te muestres", "se muestre", "nos mostremos", "os mostr√©is", "se muestren"]
        },
        {
            verb: "saber", // Nuevo
            tag: "Totalmente Irregular",
            auto: false,
            forms: ["sepa", "sepas", "sepa", "sepamos", "sep√°is", "sepan"]
        },
        {
            verb: "transmitir", // Nuevo
            tag: "Regular -IR",
            auto: true // Magia
        }
    ];

    // ======================================================
    // ‚öôÔ∏è MOTOR DEL SISTEMA (NO NECESITAS TOCAR ABAJO)
    // ======================================================

    // 1. Conjugador Autom√°tico para Regulares
    function conjugateRegular(verb) {
        const ending = verb.slice(-2);
        const stem = verb.slice(0, -2);
        
        if (ending === "ar") {
            return [stem + "e", stem + "es", stem + "e", stem + "emos", stem + "√©is", stem + "en"];
        } else if (ending === "er" || ending === "ir") {
            return [stem + "a", stem + "as", stem + "a", stem + "amos", stem + "√°is", stem + "an"];
        }
        return ["error", "error", "error", "error", "error", "error"];
    }

    // 2. Generador de HTML
    function renderApp() {
        const container = document.getElementById('cardsContainer');
        const select = document.getElementById('verbSelect');
        
        container.innerHTML = ""; // Limpiar
        
        // Llenar Select y Tarjetas
        verbDatabase.forEach(item => {
            // 1. A√±adir al Select
            const option = document.createElement('option');
            option.value = item.verb;
            option.textContent = item.verb.charAt(0).toUpperCase() + item.verb.slice(1);
            select.appendChild(option);

            // 2. Calcular Formas
            let forms = item.auto ? conjugateRegular(item.verb) : item.forms;

            // 3. Crear HTML de la Tarjeta
            const cardHTML = `
                <div class="verb-card" data-verb="${item.verb}">
                    <div class="card-header">
                        <span class="verb-title">${item.verb}</span>
                        <span class="verb-tag">${item.tag}</span>
                    </div>
                    <table>
                        ${createRow('yo', forms[0])}
                        ${createRow('t√∫', forms[1])}
                        ${createRow('√©l/ella/Ud.', forms[2])}
                        ${createRow('nosotros', forms[3])}
                        ${createRow('vosotros', forms[4])}
                        ${createRow('ellos/Uds.', forms[5])}
                    </table>
                    <div class="chip-row">
                        <span class="chip">que ${forms[0]}</span>
                        <span class="chip">que ${forms[5]}</span>
                    </div>
                </div>
            `;
            container.innerHTML += cardHTML;
        });
    }

    function createRow(pronoun, form) {
        return `<tr>
                    <td class="pronoun">${pronoun}</td>
                    <td class="form" onclick="speak('${form}')">${form} <span class="tts-icon">üîä</span></td>
                </tr>`;
    }

    // --- UI Interactions ---

    document.addEventListener('DOMContentLoaded', () => {
        renderApp(); // Inicializar todo
        setupFilters();
    });

    function setupFilters() {
        const select = document.getElementById('verbSelect');
        
        select.addEventListener('change', () => {
            const val = select.value;
            document.querySelectorAll('.verb-card').forEach(card => {
                if(val === 'all' || card.dataset.verb === val) {
                    card.style.display = '';
                } else {
                    card.style.display = 'none';
                }
            });
        });

        document.getElementById('hideBtn').addEventListener('click', () => {
            document.querySelectorAll('.form').forEach(td => {
                if(!td.dataset.original) {
                    // Guardar texto original (sin el icono)
                    td.dataset.original = td.innerText.replace('üîä', '').trim();
                }
                td.innerHTML = `________ <span class="tts-icon">üîä</span>`;
                td.classList.add('hidden-form');
            });
        });

        document.getElementById('showBtn').addEventListener('click', () => {
            document.querySelectorAll('.form').forEach(td => {
                if(td.dataset.original) {
                    td.innerHTML = `${td.dataset.original} <span class="tts-icon">üîä</span>`;
                }
                td.classList.remove('hidden-form');
            });
        });
    }

    // --- Audio & Theme Engines (Reutilizados de la Suite) ---

    function speak(txt) {
        window.speechSynthesis.cancel();
        const u = new SpeechSynthesisUtterance(txt);
        u.lang = 'es-ES';
        const voices = window.speechSynthesis.getVoices();
        // Priorizar voces premium (Google, Microsoft)
        const v = voices.find(voice => voice.name.includes('Google') && voice.lang.includes('es')) || 
                  voices.find(voice => voice.lang.includes('es'));
        if(v) u.voice = v;
        window.speechSynthesis.speak(u);
    }

    function toggleTheme() {
        document.body.classList.toggle('dark-mode');
    }

    const uiStrings = {
        en: { title: "Present Subjunctive", subtitle: "Activity 16: Dynamic Verb Practice", filter: "Filter Verb:", hide: "üëÅÔ∏è Hide Forms", show: "üëÅÔ∏è Show Forms", hint: "Tip: Click 'Hide', try to pronounce it, then click üîä to check." },
        es: { title: "Presente del Subjuntivo", subtitle: "Actividad 16: Pr√°ctica Din√°mica", filter: "Filtrar Verbo:", hide: "üëÅÔ∏è Ocultar Formas", show: "üëÅÔ∏è Mostrar Formas", hint: "Tip: Haz clic en 'Ocultar', intenta pronunciarlo y luego haz clic en üîä para verificar." }
    };
    let currentLang = 'es';

    function toggleLang() {
        currentLang = currentLang === 'es' ? 'en' : 'es';
        const t = uiStrings[currentLang];
        document.getElementById('app-title').textContent = t.title;
        document.getElementById('app-subtitle').textContent = t.subtitle;
        document.getElementById('lbl-filter').textContent = t.filter;
        document.getElementById('hideBtn').textContent = t.hide;
        document.getElementById('showBtn').textContent = t.show;
        document.getElementById('app-hint').textContent = t.hint;
    }

    window.speechSynthesis.onvoiceschanged = () => {}; 

</script>
</body>
</html>